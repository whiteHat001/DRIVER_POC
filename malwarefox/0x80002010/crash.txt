
kd> g
KDTARGET: Refreshing KD connection

*** Fatal System Error: 0x0000003b
                       (0x00000000C0000005,0xFFFFF80113060284,0xFFFFD001BBDACC50,0x0000000000000000)

Break instruction exception - code 80000003 (first chance)

A fatal system error has occurred.
Debugger entered on first try; Bugcheck callbacks have not been invoked.

A fatal system error has occurred.

Connected to Windows 10 10586 x64 target at (Mon Jan 15 20:17:54.138 2018 (UTC + 8:00)), ptr64 TRUE
Loading Kernel Symbols
..................................

Press ctrl-c (cdb, kd, ntsd) or ctrl-break (windbg) to abort symbol loads that take too long.
Run !sym noisy before .reload to track down problems loading symbols.

.............................
................................................................
...............................................
Loading User Symbols
............
Loading unloaded module list
.....
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

Use !analyze -v to get detailed debugging information.

BugCheck 3B, {c0000005, fffff80113060284, ffffd001bbdacc50, 0}

*** ERROR: Module load completed but symbols could not be loaded for zam64.sys
*** WARNING: Unable to verify checksum for anvirus.exe
Debugger extension ext.Analyze execution is cancelled.
      PC: 00007ffa`98513fb8  VA: 006d006f`0063002e  R/W: 9  Parameter: 0077006f`0064002f
nt!DbgBreakPointWithStatus:
fffff802`ed1556d0 cc              int     3
kd> !analyze -v
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

SYSTEM_SERVICE_EXCEPTION (3b)
An exception happened while executing a system service routine.
Arguments:
Arg1: 00000000c0000005, Exception code that caused the bugcheck
Arg2: fffff80113060284, Address of the instruction which caused the bugcheck
Arg3: ffffd001bbdacc50, Address of the context record for the exception that caused the bugcheck
Arg4: 0000000000000000, zero.

Debugging Details:
------------------


DUMP_CLASS: 1

DUMP_QUALIFIER: 0

BUILD_VERSION_STRING:  10586.0.amd64fre.th2_release.151029-1700

DUMP_TYPE:  0

BUGCHECK_P1: c0000005

BUGCHECK_P2: fffff80113060284

BUGCHECK_P3: ffffd001bbdacc50

BUGCHECK_P4: 0

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - <Unable to get error code text>

FAULTING_IP: 
zam64+10284
fffff801`13060284 8b0b            mov     ecx,dword ptr [rbx]

CONTEXT:  ffffd001bbdacc50 -- (.cxr 0xffffd001bbdacc50)
rax=0000000000000001 rbx=0000000000000000 rcx=0000000000000000
rdx=0000000000000000 rsi=0000000000000000 rdi=00000000c0000001
rip=fffff80113060284 rsp=ffffd001bbdad670 rbp=0000000000001460
 r8=0000000000000208  r9=fffff801130706b0 r10=0000000000000001
r11=fffff802ed15bb93 r12=0000000000000000 r13=fffff801130706b0
r14=0000000000000000 r15=ffffe00127e20b80
iopl=0         nv up ei pl nz na pe nc
cs=0010  ss=0018  ds=002b  es=002b  fs=0053  gs=002b             efl=00010202
zam64+0x10284:
fffff801`13060284 8b0b            mov     ecx,dword ptr [rbx] ds:002b:00000000`00000000=????????
Resetting default scope

CPU_COUNT: 1

CPU_MHZ: af8

CPU_VENDOR:  GenuineIntel

CPU_FAMILY: 6

CPU_MODEL: 9e

CPU_STEPPING: 9

CPU_MICROCODE: 6,9e,9,0 (F,M,S,R)  SIG: 5E'00000000 (cache) 5E'00000000 (init)

DEFAULT_BUCKET_ID:  WIN8_DRIVER_FAULT

BUGCHECK_STR:  0x3B

PROCESS_NAME:  anvirus.exe

CURRENT_IRQL:  0

ANALYSIS_SESSION_HOST:  DESKTOP-PL54RSL

ANALYSIS_SESSION_TIME:  01-15-2018 20:19:46.0750

ANALYSIS_VERSION: 10.0.16299.15 amd64fre

LAST_CONTROL_TRANSFER:  from fffff80113060701 to fffff80113060284

STACK_TEXT:  
ffffd001`bbdad670 fffff801`13060701 : 000000fb`dad0fdd8 ffffd001`bbdada80 00000000`00000001 fffff802`ed3feb75 : zam64+0x10284
ffffd001`bbdad6a0 fffff802`ed3f6575 : ffffe001`00000000 ffffe001`27e20b80 ffffd001`bbdada80 ffffe001`29160320 : zam64+0x10701
ffffd001`bbdad710 fffff802`ed3f5d16 : fffff801`143c4020 00000000`00000000 00000000`00000000 00000000`00000000 : nt!IopXxxControlFile+0x855
ffffd001`bbdad920 fffff802`ed15a7a3 : fffff6fb`7dafffc0 00000000`00000000 00000000`00000000 00000000`00000000 : nt!NtDeviceIoControlFile+0x56
ffffd001`bbdad990 00007ffe`1d524e34 : 00007ffe`19d8c833 00007ffe`18d24168 00000000`c0000000 00000000`00000000 : nt!KiSystemServiceCopyEnd+0x13
000000fb`dad0fdb8 00007ffe`19d8c833 : 00007ffe`18d24168 00000000`c0000000 00000000`00000000 000000fb`dad0fde0 : ntdll!NtDeviceIoControlFile+0x14
000000fb`dad0fdc0 00007ffe`1a9fb394 : 00000000`80002010 00000000`00000004 00007ff7`8a8d3300 000000fb`dad0fe88 : KERNELBASE!DeviceIoControl+0x73
000000fb`dad0fe30 00007ff7`8a8d10c6 : 00000000`0000007c 00007ffe`18d255f0 00000000`00000000 000000fb`dae00000 : KERNEL32!DeviceIoControlImplementation+0xc4
000000fb`dad0fe80 00000000`0000007c : 00007ffe`18d255f0 00000000`00000000 000000fb`dae00000 00000000`00000000 : anvirus!main+0xc6 [c:\users\haier\source\repos\anvirus\anvirus\anvirus.cpp @ 76] 
000000fb`dad0fe88 00007ffe`18d255f0 : 00000000`00000000 000000fb`dae00000 00000000`00000000 00007ff7`00000000 : 0x7c
000000fb`dad0fe90 00000000`00000000 : 000000fb`dae00000 00000000`00000000 00007ff7`00000000 000000fb`dad0fec0 : ucrtbase!_pioinfo


THREAD_SHA1_HASH_MOD_FUNC:  64dea6e94725f9cb010a5523f46256838dd1e9a7

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  f09bfbff96f0c111cc15879c2c56e0fd8f7b1c38

THREAD_SHA1_HASH_MOD:  5b11a012f248ab910202baace26f4037abcab45e

FOLLOWUP_IP: 
zam64+10284
fffff801`13060284 8b0b            mov     ecx,dword ptr [rbx]

FAULT_INSTR_CODE:  25e80b8b

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  zam64+10284

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: zam64

IMAGE_NAME:  zam64.sys

DEBUG_FLR_IMAGE_TIMESTAMP:  57b499ad

STACK_COMMAND:  .cxr 0xffffd001bbdacc50 ; kb

BUCKET_ID_FUNC_OFFSET:  10284

FAILURE_BUCKET_ID:  0x3B_zam64!unknown_function

BUCKET_ID:  0x3B_zam64!unknown_function

PRIMARY_PROBLEM_CLASS:  0x3B_zam64!unknown_function

TARGET_TIME:  2018-01-15T12:17:38.000Z

OSBUILD:  10586

OSSERVICEPACK:  0

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

SUITE_MASK:  272

PRODUCT_TYPE:  1

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

OSEDITION:  Windows 10 WinNt TerminalServer SingleUserTS

OS_LOCALE:  

USER_LCID:  0

OSBUILD_TIMESTAMP:  2015-10-30 10:15:45

BUILDDATESTAMP_STR:  151029-1700

BUILDLAB_STR:  th2_release

BUILDOSVER_STR:  10.0.10586.0.amd64fre.th2_release.151029-1700

ANALYSIS_SESSION_ELAPSED_TIME:  5f95

ANALYSIS_SOURCE:  KM

FAILURE_ID_HASH_STRING:  km:0x3b_zam64!unknown_function

FAILURE_ID_HASH:  {cc6b6fb8-468b-def7-877d-070337fb32ce}

Followup:     MachineOwner
---------

