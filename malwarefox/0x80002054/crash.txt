
Microsoft (R) Windows Debugger Version 10.0.16299.15 AMD64
Copyright (c) Microsoft Corporation. All rights reserved.

Opened \\.\pipe\com_1
Waiting to reconnect...
Connected to Windows 10 10586 x64 target at (Mon Jan 15 20:21:52.604 2018 (UTC + 8:00)), ptr64 TRUE
Kernel Debugger connection established.

************* Path validation summary **************
Response                         Time (ms)     Location
Deferred                                       srv*d:\symbols*http://msdl.microsoft.com/download/symbols
Symbol search path is: srv*d:\symbols*http://msdl.microsoft.com/download/symbols
Executable search path is: 
Windows 10 Kernel Version 10586 MP (1 procs) Free x64
Built by: 10586.0.amd64fre.th2_release.151029-1700
Machine Name:
Kernel base = 0xfffff800`a5082000 PsLoadedModuleList = 0xfffff800`a5360cb0
System Uptime: 0 days 0:00:00.156
nt!DebugService2+0x5:
fffff800`a51c9725 cc              int     3
kd> g
KDTARGET: Refreshing KD connection
KDTARGET: Refreshing KD connection

*** Fatal System Error: 0x0000003b
                       (0x00000000C0000005,0xFFFFF801CF0A0A83,0xFFFFD001CBCBAC80,0x0000000000000000)

Break instruction exception - code 80000003 (first chance)

A fatal system error has occurred.
Debugger entered on first try; Bugcheck callbacks have not been invoked.

A fatal system error has occurred.

Connected to Windows 10 10586 x64 target at (Mon Jan 15 20:45:53.369 2018 (UTC + 8:00)), ptr64 TRUE
Loading Kernel Symbols
.......................................

Press ctrl-c (cdb, kd, ntsd) or ctrl-break (windbg) to abort symbol loads that take too long.
Run !sym noisy before .reload to track down problems loading symbols.

........................
................................................................
..............................................
Loading User Symbols
............
Loading unloaded module list
.....
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

Use !analyze -v to get detailed debugging information.

BugCheck 3B, {c0000005, fffff801cf0a0a83, ffffd001cbcbac80, 0}

*** ERROR: Module load completed but symbols could not be loaded for zam64.sys
*** WARNING: Unable to verify checksum for anvirus.exe
Probably caused by : zam64.sys ( zam64+10a83 )

Followup:     MachineOwner
---------

nt!DbgBreakPointWithStatus:
fffff800`a51c96d0 cc              int     3
kd> !analyze -v
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

SYSTEM_SERVICE_EXCEPTION (3b)
An exception happened while executing a system service routine.
Arguments:
Arg1: 00000000c0000005, Exception code that caused the bugcheck
Arg2: fffff801cf0a0a83, Address of the instruction which caused the bugcheck
Arg3: ffffd001cbcbac80, Address of the context record for the exception that caused the bugcheck
Arg4: 0000000000000000, zero.

Debugging Details:
------------------


DUMP_CLASS: 1

DUMP_QUALIFIER: 0

BUILD_VERSION_STRING:  10586.0.amd64fre.th2_release.151029-1700

DUMP_TYPE:  0

BUGCHECK_P1: c0000005

BUGCHECK_P2: fffff801cf0a0a83

BUGCHECK_P3: ffffd001cbcbac80

BUGCHECK_P4: 0

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - <Unable to get error code text>

FAULTING_IP: 
zam64+10a83
fffff801`cf0a0a83 c7061e010000    mov     dword ptr [rsi],11Eh

CONTEXT:  ffffd001cbcbac80 -- (.cxr 0xffffd001cbcbac80)
rax=ffffe000d780f9f0 rbx=0000000080002054 rcx=19b0c4349d2e0000
rdx=fffff801cf0b0270 rsi=0000000000000000 rdi=00000000c0000001
rip=fffff801cf0a0a83 rsp=ffffd001cbcbb6a0 rbp=0000000000000608
 r8=00000000000002a3  r9=fffff801cf0b06b0 r10=0000000000000001
r11=fffff800a51cfb93 r12=0000000000000000 r13=fffff801cf0b06b0
r14=0000000000000000 r15=ffffe000d673b710
iopl=0         nv up ei ng nz na pe nc
cs=0010  ss=0018  ds=002b  es=002b  fs=0053  gs=002b             efl=00010282
zam64+0x10a83:
fffff801`cf0a0a83 c7061e010000    mov     dword ptr [rsi],11Eh ds:002b:00000000`00000000=????????
Resetting default scope

CPU_COUNT: 1

CPU_MHZ: af8

CPU_VENDOR:  GenuineIntel

CPU_FAMILY: 6

CPU_MODEL: 9e

CPU_STEPPING: 9

CPU_MICROCODE: 6,9e,9,0 (F,M,S,R)  SIG: 5E'00000000 (cache) 5E'00000000 (init)

DEFAULT_BUCKET_ID:  WIN8_DRIVER_FAULT

BUGCHECK_STR:  0x3B

PROCESS_NAME:  anvirus.exe

CURRENT_IRQL:  0

ANALYSIS_SESSION_HOST:  DESKTOP-PL54RSL

ANALYSIS_SESSION_TIME:  01-15-2018 20:46:31.0432

ANALYSIS_VERSION: 10.0.16299.15 amd64fre

LAST_CONTROL_TRANSFER:  from fffff800a546a575 to fffff801cf0a0a83

STACK_TEXT:  
ffffd001`cbcbb6a0 fffff800`a546a575 : ffffe000`00000000 ffffe000`d673b710 ffffd001`cbcbba80 ffffe000`d7ce5090 : zam64+0x10a83
ffffd001`cbcbb710 fffff800`a5469d16 : fffff801`d0744020 00000000`00000000 00000000`00000000 00000000`00000000 : nt!IopXxxControlFile+0x855
ffffd001`cbcbb920 fffff800`a51ce7a3 : fffff6fb`7dafffc0 00000000`00000000 00000000`00000000 00000000`00000000 : nt!NtDeviceIoControlFile+0x56
ffffd001`cbcbb990 00007ffe`0c184e34 : 00007ffe`0927c833 00007ffe`07984168 00000000`c0000000 00000000`00000000 : nt!KiSystemServiceCopyEnd+0x13
000000c2`a3eff738 00007ffe`0927c833 : 00007ffe`07984168 00000000`c0000000 00000000`00000000 000000c2`a3eff760 : ntdll!NtDeviceIoControlFile+0x14
000000c2`a3eff740 00007ffe`0a76b394 : 00000000`80002054 00000000`00000004 00007ff6`34553300 000000c2`a3eff808 : KERNELBASE!DeviceIoControl+0x73
000000c2`a3eff7b0 00007ff6`345510c6 : 00000000`0000007c 00007ffe`079855f0 00000000`00000000 000000c2`a3d39000 : KERNEL32!DeviceIoControlImplementation+0xc4
000000c2`a3eff800 00000000`0000007c : 00007ffe`079855f0 00000000`00000000 000000c2`a3d39000 00000000`00000000 : anvirus!main+0xc6 [c:\users\haier\source\repos\anvirus\anvirus\anvirus.cpp @ 76] 
000000c2`a3eff808 00007ffe`079855f0 : 00000000`00000000 000000c2`a3d39000 00000000`00000000 00007ff6`00000000 : 0x7c
000000c2`a3eff810 00000000`00000000 : 000000c2`a3d39000 00000000`00000000 00007ff6`00000000 000000c2`a3eff840 : ucrtbase!_pioinfo


THREAD_SHA1_HASH_MOD_FUNC:  49fa23ae67c5568a8506716e1e1eef3918d67860

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  e85149f8f03bad7fa92ca4208363f50201890edf

THREAD_SHA1_HASH_MOD:  c2600dea58655e4a0189f33b156ac083908d85fb

FOLLOWUP_IP: 
zam64+10a83
fffff801`cf0a0a83 c7061e010000    mov     dword ptr [rsi],11Eh

FAULT_INSTR_CODE:  11e06c7

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  zam64+10a83

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: zam64

IMAGE_NAME:  zam64.sys

DEBUG_FLR_IMAGE_TIMESTAMP:  57b499ad

STACK_COMMAND:  .cxr 0xffffd001cbcbac80 ; kb

BUCKET_ID_FUNC_OFFSET:  10a83

FAILURE_BUCKET_ID:  0x3B_zam64!unknown_function

BUCKET_ID:  0x3B_zam64!unknown_function

PRIMARY_PROBLEM_CLASS:  0x3B_zam64!unknown_function

TARGET_TIME:  2018-01-15T12:45:52.000Z

OSBUILD:  10586

OSSERVICEPACK:  0

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

SUITE_MASK:  272

PRODUCT_TYPE:  1

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

OSEDITION:  Windows 10 WinNt TerminalServer SingleUserTS

OS_LOCALE:  

USER_LCID:  0

OSBUILD_TIMESTAMP:  2015-10-30 10:15:45

BUILDDATESTAMP_STR:  151029-1700

BUILDLAB_STR:  th2_release

BUILDOSVER_STR:  10.0.10586.0.amd64fre.th2_release.151029-1700

ANALYSIS_SESSION_ELAPSED_TIME:  6dc

ANALYSIS_SOURCE:  KM

FAILURE_ID_HASH_STRING:  km:0x3b_zam64!unknown_function

FAILURE_ID_HASH:  {cc6b6fb8-468b-def7-877d-070337fb32ce}

Followup:     MachineOwner
---------

